---
- name: Generate log directory
  file:
      path: "{{ log_base }}"
      state: directory

- name: "[ {{ exp_id }}/{{ sub_exp }} | {{ worker_threads }} | {{ vc }}/{{ repetition }}] {{ type }} - {{ memtier_target }}:{{ memtier_target_port }}"
  shell: |
      {{ dstat_cmd }} > {{ log_memtier_dstat }} &
      ping {{ memtier_target }} > {{ log_memtier_ping }} &
      {{ mt_cmd_log }}

- name: Fixing history log
  command: perl -p -i -e 's/\r/\n/g' {{ log_memtier_stderr }}

- name: Sleeping 3 seconds
  pause:
      seconds: 3
